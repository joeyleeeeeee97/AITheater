# AI Theater Scripting Protocol v2.1

This document defines the mandatory JSON structure for events generated by the script writer. The video generator relies on this exact structure to render the game state correctly.

### **Core Event Structure**

Every event object in the output array MUST contain:

-   `"event_type"`: (String) The type of event.
-   `"summary"`: (String) A concise, third-person summary of the event.
-   `"content"`: (String) The narrative or dialogue content for the voice actor.

For events initiated by a player, the following key is **MANDATORY**:

-   `"player_id"`: (Integer) The ID of the player speaking or acting.

The following state objects are **OPTIONAL**. They should ONLY be included if their values have **changed** since the previous event.

-   `"game_state"`: (Object) The state of the game at the moment of the event.
-   `"quest_dashboard_state"`: (Array of Objects) The cumulative results of all completed quests.

---

### **Event Type Examples**

#### `PLAYER_SPEECH`
This is for any player making a statement during a discussion. It **MUST** include a `player_id`.

**Example:**
```json
{
  "event_type": "PLAYER_SPEECH",
  "player_id": 3,
  "summary": "Player 3 (Oberon) argues against the proposed team.",
  "content": "This proposal is a textbook case of misdirection, and we must reject it."
}
```

#### `TEAM_PROPOSAL`
This is for the leader proposing a team. It **MUST** include the leader's `player_id`.

**Example:**
```json
{
  "event_type": "TEAM_PROPOSAL",
  "player_id": 2,
  "summary": "Player 2 proposes team [0, 2, 5] for the quest.",
  "content": "Player 0 must be tested again immediately. My team is 0, 2, and 5.",
  "game_state": {
    "current_leader": 2,
    "proposed_team": [0, 2, 5]
  }
}
```

#### `LEADER_DECISION`
This is for the leader finalizing their team. It **MUST** include the leader's `player_id`.

**Example:**
```json
{
  "event_type": "LEADER_DECISION",
  "player_id": 2,
  "summary": "Leader 2 finalizes the team to [0, 4, 5].",
  "content": "I've heard the table's concerns. My final team is 0, 4, and 5."
}
```

#### `NARRATOR_SPEECH`
This is for any narrator line. It **DOES NOT** have a `player_id`.

**Example:**
```json
{
  "event_type": "NARRATOR_SPEECH",
  "summary": "The narrator announces the start of Quest 3.",
  "content": "And now, the third quest shall begin."
}
```

---

### **Key-Specific Schemas**

#### 1. `game_state` Object

Include this object **only when the leader or proposed team changes**.

-   `"current_leader"`: (Integer | null) The player ID of the current leader.
-   `"proposed_team"`: (Array of Integers | null) The team currently on the table for voting.

#### 2. `quest_dashboard_state` Array

Include this object **only when a quest has just been completed**.

-   Each item in the array is an **Object** representing one completed quest.
-   The object MUST contain:
    -   `"quest_number"`: (Integer) The quest number (1-5).
    -   `"team"`: (Array of Integers) The players who went on the quest.
    -   `"result"`: (String) The outcome, either "SUCCESS" or "FAILURE".
